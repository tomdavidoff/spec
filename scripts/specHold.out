
R version 4.4.0 (2024-04-24) -- "Puppy Cup"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # specHold.R 
> # how long to spec builders hold properties?
> # Also, when do they buy?
> # Tom Davidoff
> # 06/04/25
> 
> # strategy: find last sale before year built for single family homes
> # consider doing for all teardowns class of 2016, but see how long hold is first
> # do this for each metro area
> 
> library(data.table)
> library(fixest)	
> library(RSQLite)
> 
> # get dates of construction for single family homes 
> # see if roll number ends in zero and no other by lot start works
> 
> DOCOMPILE <- TRUE
> 
> if (DOCOMPILE==TRUE) {
+ 	dr <- unique(fread("~/OneDrive\ -\ UBC/Documents/data/bca/data_advice_REVD25_20250331/bca_folio_descriptions_20250331_REVD25.csv",select=c("JURISDICTION_CODE","REGIONAL_DISTRICT"),colClasses=c(ROLL_NUMBER="character")))
+ 
+ 	dd25 <- fread("~/OneDrive\ -\ UBC/Documents/data/bca/data_advice_REVD25_20250331/bca_folio_descriptions_20250331_REVD25.csv",select=c("JURISDICTION_CODE","ROLL_NUMBER","FOLIO_ID","ACTUAL_USE_DESCRIPTION"),colClasses=c(ROLL_NUMBER="character"))
+ 	print(summary(dd25))
+ 	print(summary(dd25))
+ 	dj25 <- unique(dd25[,.(JURISDICTION_CODE,ROLL_NUMBER,FOLIO_ID)]) # for sales data uniformity
+ 	print(dj25[1:20])
+ 	names(dj25) <- c("JURISDICTION_CODE","ROLL_NUMBER","FOLIO_ID")
+ 	print(dj25[1:20])
+ 
+ 	diri <- "~/OneDrive - UBC/Documents/data/bca/Residential_inventory_202501/"
+ 	dirf <- list.files(diri)[1:2]
+ 
+ 	di25 <- data.table(Jurisdiction=numeric(),Roll_Number=character(),MB_Year_Built=numeric(),MB_Effective_Year=numeric())
+ 	for (f in paste0(diri,dirf)) {
+ 		d <- fread(f,select=c("Jurisdiction","Roll_Number","MB_Year_Built","MB_Effective_Year"),colClasses=c(Roll_Number="character",Jurisdiction="numeric") )
+ 		di25 <- rbind(di25,d)
+ 	}
+ 	di25 <- di25[!is.na(MB_Year_Built)]
+ 	# to date 20250312000000
+ 
+ 	d25 <- merge(dd25,di25,by.x=c("JURISDICTION_CODE","ROLL_NUMBER"),by.y=c("Jurisdiction","Roll_Number"))
+ 	print(summary(d25))
+ 
+ 	ds25 <- fread("~/OneDrive - UBC/Documents/data/bca/data_advice_REVD25_20250331/bca_folio_sales_20250331_REVD25.csv",select=c("FOLIO_ID","CONVEYANCE_DATE","CONVEYANCE_PRICE","CONVEYANCE_TYPE_DESCRIPTION"),colClasses=c(CONVEYANCE_DATE="character"))
+ 	# convert folioID to jurisdiction/roll_number as pre-redevelopment sales will have often same jurisd/roll_number, different FOLIO_ID. Certainly same rollStart
+ 	ds25[,CONVEYANCE_DATE:=as.Date(CONVEYANCE_DATE,format="%Y%m%d%H%M%S")]
+ 	print("probnlem 25")
+ 	print(summary(ds25))
+ 	print(summary(dj25))
+ 	print(ds25[1:10])
+ 	print(dj25[1:10])
+ 	ds25 <- merge(ds25,dj25,by="FOLIO_ID") # add jurisdiction code and roll number
+ 
+ 	# get sales data from 2016 to maximize chain of sales
+ 	# open an sqlite connection to ~/docs/data/bca/REVD16_and_inventory_extracts.sqlite3
+ 	print("trying16")
+ 	db16 <- dbConnect(RSQLite::SQLite(), "~/OneDrive - UBC/Documents/data/bca/REVD16_and_inventory_extracts.sqlite3")
+ 	df16 <- dbGetQuery(db16, "SELECT folioID, jurisdictionCode, rollNumber FROM folio") 
+ 	ds16 <- dbGetQuery(db16, "SELECT folioID, conveyanceDate, conveyancePrice, conveyanceTypeDescription FROM sales")
+ 	print(summary(df16))
+ 	print(summary(ds16))
+ 	print("DD?")
+ 	ds16 <- data.table(merge(df16,ds16,by="folioID"))
+ 	setnames(ds16,c("jurisdictionCode","rollNumber","conveyanceDate","conveyancePrice","conveyanceTypeDescription","folioID"),c("JURISDICTION_CODE","ROLL_NUMBER","CONVEYANCE_DATE","CONVEYANCE_PRICE","CONVEYANCE_TYPE_DESCRIPTION","FOLIO_ID"))
+ 	print(ds16[1:10,CONVEYANCE_DATE])
+ 	ds16[,CONVEYANCE_DATE:=as.Date(CONVEYANCE_DATE,format="%Y-%m-%d")]
+ 	print("ds16then25")
+ 	print(ds16[1:20,])
+ 	print(summary(ds25))
+ 	print(ds25[1:20])
+ 	ds25 <- unique(rbind(ds25,ds16))
+ 	print("winner!")
+ 	print(d25[1:20,])
+ 	print(ds25[1:20,])
+ 	ds25[,JURISDICTION_CODE:=as.numeric(JURISDICTION_CODE)]
+ 	d25 <- merge(d25,ds25,by=c("JURISDICTION_CODE","ROLL_NUMBER")) # add sales data
+ 	d25 <- merge(d25,dr,by="JURISDICTION_CODE") # add regional district
+ 	d25[,rollStart:=substring(ROLL_NUMBER,1,nchar(ROLL_NUMBER)-1)]
+ 	d25[,nRoll:=.N,by=rollStart]
+ 
+ 	fwrite(d25,"data/derived/specHold25.csv")
+ 
+ }
 JURISDICTION_CODE ROLL_NUMBER          FOLIO_ID         ACTUAL_USE_DESCRIPTION
 Min.   :200.0     Length:2207711     Length:2207711     Length:2207711        
 1st Qu.:228.0     Class :character   Class :character   Class :character      
 Median :314.0     Mode  :character   Mode  :character   Mode  :character      
 Mean   :383.4                                                                 
 3rd Qu.:426.0                                                                 
 Max.   :792.0                                                                 
 JURISDICTION_CODE ROLL_NUMBER          FOLIO_ID         ACTUAL_USE_DESCRIPTION
 Min.   :200.0     Length:2207711     Length:2207711     Length:2207711        
 1st Qu.:228.0     Class :character   Class :character   Class :character      
 Median :314.0     Mode  :character   Mode  :character   Mode  :character      
 Mean   :383.4                                                                 
 3rd Qu.:426.0                                                                 
 Max.   :792.0                                                                 
    JURISDICTION_CODE     ROLL_NUMBER   FOLIO_ID
                <int>          <char>     <char>
 1:               200 001025638140000 A00000002S
 2:               200 001025638280000 A00000002T
 3:               200 001025638480000 A00000002U
 4:               200 001025638660000 A00000002V
 5:               200 001025638920000 A00000002W
 6:               200 001025638950000 A00000002X
 7:               200 001026633940000 A00000002Y
 8:               200 001026636450000 A00000002Z
 9:               200 001026643080000 A000000030
10:               200 001026646980000 A000000031
11:               200 001026683240000 D0000150K1
12:               200 001026683440000 A000000033
13:               200 001026683540000 A000000034
14:               200 001026683740000 A000000035
15:               200 001026683940000 A000000036
16:               200 001027621860000 A000000037
17:               200 001027621880000 J000003SWX
18:               200 001027621960000 A000000038
19:               200 001027683060000 A000000039
20:               200 001027683460000 A00000003A
    JURISDICTION_CODE     ROLL_NUMBER   FOLIO_ID
    JURISDICTION_CODE     ROLL_NUMBER   FOLIO_ID
                <int>          <char>     <char>
 1:               200 001025638140000 A00000002S
 2:               200 001025638280000 A00000002T
 3:               200 001025638480000 A00000002U
 4:               200 001025638660000 A00000002V
 5:               200 001025638920000 A00000002W
 6:               200 001025638950000 A00000002X
 7:               200 001026633940000 A00000002Y
 8:               200 001026636450000 A00000002Z
 9:               200 001026643080000 A000000030
10:               200 001026646980000 A000000031
11:               200 001026683240000 D0000150K1
12:               200 001026683440000 A000000033
13:               200 001026683540000 A000000034
14:               200 001026683740000 A000000035
15:               200 001026683940000 A000000036
16:               200 001027621860000 A000000037
17:               200 001027621880000 J000003SWX
18:               200 001027621960000 A000000038
19:               200 001027683060000 A000000039
20:               200 001027683460000 A00000003A
    JURISDICTION_CODE     ROLL_NUMBER   FOLIO_ID
 JURISDICTION_CODE ROLL_NUMBER          FOLIO_ID         ACTUAL_USE_DESCRIPTION
 Min.   :207.0     Length:257011      Length:257011      Length:257011         
 1st Qu.:250.0     Class :character   Class :character   Class :character      
 Median :309.0     Mode  :character   Mode  :character   Mode  :character      
 Mean   :400.1                                                                 
 3rd Qu.:476.0                                                                 
 Max.   :770.0                                                                 
                                                                               
 MB_Year_Built  MB_Effective_Year
 Min.   :   0   Min.   :   0     
 1st Qu.:1970   1st Qu.:1976     
 Median :1987   Median :1990     
 Mean   :1984   Mean   :1907     
 3rd Qu.:2004   3rd Qu.:2004     
 Max.   :2024   Max.   :2024     
                NA's   :36       
[1] "probnlem 25"
   FOLIO_ID         CONVEYANCE_DATE      CONVEYANCE_PRICE   
 Length:4658103     Min.   :1901-06-21   Min.   :0.000e+00  
 Class :character   1st Qu.:1999-11-02   1st Qu.:1.370e+05  
 Mode  :character   Median :2009-12-14   Median :2.950e+05  
                    Mean   :2007-11-30   Mean   :4.904e+05  
                    3rd Qu.:2018-01-03   3rd Qu.:5.600e+05  
                    Max.   :2025-03-14   Max.   :1.250e+09  
                                         NA's   :26656      
 CONVEYANCE_TYPE_DESCRIPTION
 Length:4658103             
 Class :character           
 Mode  :character           
                            
                            
                            
                            
 JURISDICTION_CODE ROLL_NUMBER          FOLIO_ID        
 Min.   :200.0     Length:2207711     Length:2207711    
 1st Qu.:228.0     Class :character   Class :character  
 Median :314.0     Mode  :character   Mode  :character  
 Mean   :383.4                                          
 3rd Qu.:426.0                                          
 Max.   :792.0                                          
      FOLIO_ID CONVEYANCE_DATE CONVEYANCE_PRICE
        <char>          <Date>            <int>
 1: A000000045      2008-04-15          2775000
 2: A000000045      1988-08-30           570000
 3: A000000045      1983-01-27           266000
 4: A000000046      2012-10-31          2698000
 5: A000000047      1977-11-15           111500
 6: A00000004B      2004-03-15           170000
 7: A00000004C      2012-01-12          1647333
 8: A00000004C      1995-04-27           751000
 9: A00000004C      1986-05-23           260000
10: A00000004D      2024-05-01          5070000
                 CONVEYANCE_TYPE_DESCRIPTION
                                      <char>
 1:     Improved Single Property Transaction
 2:     Improved Single Property Transaction
 3:     Improved Single Property Transaction
 4:     Improved Single Property Transaction
 5:     Improved Single Property Transaction
 6: Reject - Not Suitable for Sales Analysis
 7: Reject - Not Suitable for Sales Analysis
 8:     Improved Single Property Transaction
 9:     Improved Single Property Transaction
10:     Improved Single Property Transaction
    JURISDICTION_CODE     ROLL_NUMBER   FOLIO_ID
                <int>          <char>     <char>
 1:               200 001025638140000 A00000002S
 2:               200 001025638280000 A00000002T
 3:               200 001025638480000 A00000002U
 4:               200 001025638660000 A00000002V
 5:               200 001025638920000 A00000002W
 6:               200 001025638950000 A00000002X
 7:               200 001026633940000 A00000002Y
 8:               200 001026636450000 A00000002Z
 9:               200 001026643080000 A000000030
10:               200 001026646980000 A000000031
[1] "trying16"
   folioID          jurisdictionCode    rollNumber       
 Length:1996353     Length:1996353     Length:1996353    
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
   folioID          conveyanceDate     conveyancePrice   
 Length:4040421     Length:4040421     Length:4040421    
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
 conveyanceTypeDescription
 Length:4040421           
 Class :character         
 Mode  :character         
[1] "DD?"
 [1] "2014-06-16" "2014-06-05" "1988-11-01" "2013-02-08" "1991-07-09"
 [6] "2006-12-04" "2006-10-04" "1977-04-15" "1991-09-03" "1981-07-15"
[1] "ds16then25"
      FOLIO_ID JURISDICTION_CODE     ROLL_NUMBER CONVEYANCE_DATE
        <char>            <char>          <char>          <Date>
 1: A000000009               200 001019632060000      2014-06-16
 2: A000000009               200 001019632060000      2014-06-05
 3: A000000009               200 001019632060000      1988-11-01
 4: A00000000A               200 001019632290000      2013-02-08
 5: A00000000A               200 001019632290000      1991-07-09
 6: A00000000B               200 001019632450000      2006-12-04
 7: A00000000B               200 001019632450000      2006-10-04
 8: A00000000B               200 001019632450000      1977-04-15
 9: A00000000C               200 001019632650000      1991-09-03
10: A00000000C               200 001019632650000      1981-07-15
11: A00000000C               200 001019632650000      1979-09-15
12: A00000000D               200 001019632760000      2006-07-28
13: A00000000D               200 001019632760000      1996-08-27
14: A00000000D               200 001019632760000      1975-01-15
15: A00000000E               200 001019635070000      2010-02-23
16: A00000000E               200 001019635070000      1998-05-29
17: A00000000E               200 001019635070000      1996-04-30
18: A00000000F               200 001019635170000      2014-11-13
19: A00000000F               200 001019635170000      2013-08-30
20: A00000000F               200 001019635170000      2002-11-14
      FOLIO_ID JURISDICTION_CODE     ROLL_NUMBER CONVEYANCE_DATE
    CONVEYANCE_PRICE              CONVEYANCE_TYPE_DESCRIPTION
              <char>                                   <char>
 1:          9450000     Improved Single Property Transaction
 2:                1 Reject - Not Suitable for Sales Analysis
 3:           800000 Reject - Not Suitable for Sales Analysis
 4:          8800000     Improved Single Property Transaction
 5:          1700000     Improved Single Property Transaction
 6:          3850000     Improved Single Property Transaction
 7:          2910000 Reject - Not Suitable for Sales Analysis
 8:           190000     Improved Single Property Transaction
 9:          2308000     Improved Single Property Transaction
10:           875000     Improved Single Property Transaction
11:           325000     Improved Single Property Transaction
12:          6000000     Improved Single Property Transaction
13:          4000000     Improved Single Property Transaction
14:           160000     Improved Single Property Transaction
15:          6128000     Improved Single Property Transaction
16:          2800000     Improved Single Property Transaction
17:          3068000     Improved Single Property Transaction
18:         12669000 Reject - Not Suitable for Sales Analysis
19:         14180000     Improved Single Property Transaction
20:          4500000     Improved Single Property Transaction
    CONVEYANCE_PRICE              CONVEYANCE_TYPE_DESCRIPTION
   FOLIO_ID         CONVEYANCE_DATE      CONVEYANCE_PRICE   
 Length:4658103     Min.   :1901-06-21   Min.   :0.000e+00  
 Class :character   1st Qu.:1999-11-02   1st Qu.:1.370e+05  
 Mode  :character   Median :2009-12-14   Median :2.950e+05  
                    Mean   :2007-11-30   Mean   :4.904e+05  
                    3rd Qu.:2018-01-03   3rd Qu.:5.600e+05  
                    Max.   :2025-03-14   Max.   :1.250e+09  
                                         NA's   :26656      
 CONVEYANCE_TYPE_DESCRIPTION JURISDICTION_CODE ROLL_NUMBER       
 Length:4658103              Min.   :200.0     Length:4658103    
 Class :character            1st Qu.:226.0     Class :character  
 Mode  :character            Median :312.0     Mode  :character  
                             Mean   :362.2                       
                             3rd Qu.:338.0                       
                             Max.   :792.0                       
                                                                 
Key: <FOLIO_ID>
      FOLIO_ID CONVEYANCE_DATE CONVEYANCE_PRICE
        <char>          <Date>            <int>
 1: A000000009      2019-04-05         17309000
 2: A000000009      2014-06-16          9450000
 3: A000000009      2014-06-05                1
 4: A00000000A      2013-02-08          8800000
 5: A00000000A      1991-07-09          1700000
 6: A00000000B      2006-12-04          3850000
 7: A00000000B      2006-10-04          2910000
 8: A00000000B      1977-04-15           190000
 9: A00000000C      2021-09-10         14000000
10: A00000000C      1991-09-03          2308000
11: A00000000C      1981-07-15           875000
12: A00000000D      2006-07-28          6000000
13: A00000000D      1996-08-27          4000000
14: A00000000D      1975-01-15           160000
15: A00000000E      2023-05-18         11800000
16: A00000000E      2021-09-28         12080000
17: A00000000E      2010-02-23          6128000
18: A00000000F      2025-01-10         18500000
19: A00000000F      2024-04-30         17000000
20: A00000000F      2014-11-13         12669000
      FOLIO_ID CONVEYANCE_DATE CONVEYANCE_PRICE
                 CONVEYANCE_TYPE_DESCRIPTION JURISDICTION_CODE     ROLL_NUMBER
                                      <char>             <int>          <char>
 1: Reject - Not Suitable for Sales Analysis               200 001019632060000
 2:     Improved Single Property Transaction               200 001019632060000
 3: Reject - Not Suitable for Sales Analysis               200 001019632060000
 4:     Improved Single Property Transaction               200 001019632290000
 5:     Improved Single Property Transaction               200 001019632290000
 6:     Improved Single Property Transaction               200 001019632450000
 7: Reject - Not Suitable for Sales Analysis               200 001019632450000
 8:     Improved Single Property Transaction               200 001019632450000
 9: Reject - Not Suitable for Sales Analysis               200 001019632650000
10:     Improved Single Property Transaction               200 001019632650000
11:     Improved Single Property Transaction               200 001019632650000
12:     Improved Single Property Transaction               200 001019632760000
13:     Improved Single Property Transaction               200 001019632760000
14:     Improved Single Property Transaction               200 001019632760000
15:     Improved Single Property Transaction               200 001019635070000
16:     Improved Single Property Transaction               200 001019635070000
17:     Improved Single Property Transaction               200 001019635070000
18:     Improved Single Property Transaction               200 001019635170000
19:     Improved Single Property Transaction               200 001019635170000
20: Reject - Not Suitable for Sales Analysis               200 001019635170000
                 CONVEYANCE_TYPE_DESCRIPTION JURISDICTION_CODE     ROLL_NUMBER
[1] "winner!"
Key: <JURISDICTION_CODE, ROLL_NUMBER>
    JURISDICTION_CODE ROLL_NUMBER   FOLIO_ID             ACTUAL_USE_DESCRIPTION
                <int>      <char>     <char>                             <char>
 1:               207    00020014 D00013HP95 Strata-Lot Residence (Condominium)
 2:               207    00020015 D00013HP97 Strata-Lot Residence (Condominium)
 3:               207    00020016 D00013HP9A Strata-Lot Residence (Condominium)
 4:               207    00020017 D00013HP9C Strata-Lot Residence (Condominium)
 5:               207    00020018 D00013HP9E Strata-Lot Residence (Condominium)
 6:               207    00020019 D00013HP9G Strata-Lot Residence (Condominium)
 7:               207    00020020 D00013HP9J Strata-Lot Residence (Condominium)
 8:               207    00020021 D00013HP9L Strata-Lot Residence (Condominium)
 9:               207    00020022 D00013HP9P Strata-Lot Residence (Condominium)
10:               207    00020023 D00013HP9R Strata-Lot Residence (Condominium)
11:               207    00020024 D00013HP9T Strata-Lot Residence (Condominium)
12:               207    00020025 D00013HP9V Strata-Lot Residence (Condominium)
13:               207    00020026 D00013HP9Y Strata-Lot Residence (Condominium)
14:               207    00020027 D00013HPA0 Strata-Lot Residence (Condominium)
15:               207    00020028 D00013HPA2 Strata-Lot Residence (Condominium)
16:               207    00020029 D00013HPA4 Strata-Lot Residence (Condominium)
17:               207    00020030 D00013HPA6 Strata-Lot Residence (Condominium)
18:               207    00020031 D00013HPA8 Strata-Lot Residence (Condominium)
19:               207    00020032 D00013HPAA Strata-Lot Residence (Condominium)
20:               207    00020033 D00013HPAC Strata-Lot Residence (Condominium)
    JURISDICTION_CODE ROLL_NUMBER   FOLIO_ID             ACTUAL_USE_DESCRIPTION
    MB_Year_Built MB_Effective_Year
            <num>             <num>
 1:          2017                 0
 2:          2017                 0
 3:          2017                 0
 4:          2017                 0
 5:          2017                 0
 6:          2017                 0
 7:          2017                 0
 8:          2017                 0
 9:          2017                 0
10:          2017                 0
11:          2017                 0
12:          2017                 0
13:          2017                 0
14:          2017                 0
15:          2017                 0
16:          2017                 0
17:          2017                 0
18:          2017                 0
19:          2017                 0
20:          2017                 0
    MB_Year_Built MB_Effective_Year
      FOLIO_ID CONVEYANCE_DATE CONVEYANCE_PRICE
        <char>          <Date>           <char>
 1: A000000009      2019-04-05         17309000
 2: A000000009      2014-06-16          9450000
 3: A000000009      2014-06-05                1
 4: A00000000A      2013-02-08          8800000
 5: A00000000A      1991-07-09          1700000
 6: A00000000B      2006-12-04          3850000
 7: A00000000B      2006-10-04          2910000
 8: A00000000B      1977-04-15           190000
 9: A00000000C      2021-09-10         14000000
10: A00000000C      1991-09-03          2308000
11: A00000000C      1981-07-15           875000
12: A00000000D      2006-07-28          6000000
13: A00000000D      1996-08-27          4000000
14: A00000000D      1975-01-15           160000
15: A00000000E      2023-05-18         11800000
16: A00000000E      2021-09-28         12080000
17: A00000000E      2010-02-23          6128000
18: A00000000F      2025-01-10         18500000
19: A00000000F      2024-04-30         17000000
20: A00000000F      2014-11-13         12669000
      FOLIO_ID CONVEYANCE_DATE CONVEYANCE_PRICE
                 CONVEYANCE_TYPE_DESCRIPTION JURISDICTION_CODE     ROLL_NUMBER
                                      <char>            <char>          <char>
 1: Reject - Not Suitable for Sales Analysis               200 001019632060000
 2:     Improved Single Property Transaction               200 001019632060000
 3: Reject - Not Suitable for Sales Analysis               200 001019632060000
 4:     Improved Single Property Transaction               200 001019632290000
 5:     Improved Single Property Transaction               200 001019632290000
 6:     Improved Single Property Transaction               200 001019632450000
 7: Reject - Not Suitable for Sales Analysis               200 001019632450000
 8:     Improved Single Property Transaction               200 001019632450000
 9: Reject - Not Suitable for Sales Analysis               200 001019632650000
10:     Improved Single Property Transaction               200 001019632650000
11:     Improved Single Property Transaction               200 001019632650000
12:     Improved Single Property Transaction               200 001019632760000
13:     Improved Single Property Transaction               200 001019632760000
14:     Improved Single Property Transaction               200 001019632760000
15:     Improved Single Property Transaction               200 001019635070000
16:     Improved Single Property Transaction               200 001019635070000
17:     Improved Single Property Transaction               200 001019635070000
18:     Improved Single Property Transaction               200 001019635170000
19:     Improved Single Property Transaction               200 001019635170000
20: Reject - Not Suitable for Sales Analysis               200 001019635170000
                 CONVEYANCE_TYPE_DESCRIPTION JURISDICTION_CODE     ROLL_NUMBER
Error in vecseq(f__, len__, if (allow.cartesian || notjoin || !anyDuplicated(f__,  : 
  Join results in 781921 rows; more than 724694 = nrow(x)+nrow(i). Check for duplicate key values in i each of which join to the same group in x over and over again. If that's ok, try by=.EACHI to run j for each group to avoid the large allocation. If you are sure you wish to proceed, rerun with allow.cartesian=TRUE. Otherwise, please search for this error message in the FAQ, Wiki, Stack Overflow and data.table issue tracker for advice.
Calls: merge -> merge.data.table -> [ -> [.data.table -> vecseq
Execution halted
